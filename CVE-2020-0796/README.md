![](https://images.velog.io/images/dsph9245/post/fff677e0-1c71-40ec-9074-0d5132082765/smb-ghost.jpeg)

- 취약점 번호 : CVE-2020-0796 SMB

### **_- 해당 취약점으로 인해 영향을 받는 OS 버전은?_**
```
Windows 10 Version 1903 for 32-bit Systems
Windows 10 Version 1903 for x64-based Systems
Windows 10 Version 1903 for ARM64-based Systems
Windows Server Version 1903(Server Core Installation)
Windows 10 Version 1909 for 32-bit Systems
Windows 10 Version 1909 for x64-based Systems
Windows 10 Version 1909 for ARM64-based Systems
Windows Server Version 1909(Server Core Installation)

*(Windows은 영향을 받지 않는다고 합니다.)

```

- CVE-2020-0796 SMB 취약점은 Microsoft Windows SMB 프로토콜의 메모리 파괴 취약점으로, 인증을 거치지 않은 공격자가 해당 취약점을 이용해서 
원격으로 웜과 같은 공격 효과를 하져올 수 있는 취약점이며, 또한 직접 SMB 서버를 공격하여, RCE 취약점을 악용할 수 있을 뿐만 아니라, SMB 클라이언트를 공격하여 공격자가 특정한 웹페이지, 압축파일, 공유파일, Office 문서 등을 조작하는 방식으로 취약점을 트리거할 수 있습니다. 또한, WannaCry와 같이 네트워크를 통해 전파가 가능할 수 있습니다.

- 해당 취약점은 OS가 SMB 3.1.1 프로토콜의 압축 패킷을 처리하는 과정에서 오류가 발생하여 야기되는 취약점으로, 공격자는 조작된 패킷을 악용하여 원격에서 인증을 거치지 않은 상태로 원격코드 실행이 가능합니다. 

- 추가로 해당 취약점(CVE-2020-0796)은 이러한 원격코드 실행에 대한 위험성이 EternalBlue, NotPetya, WannaCry, 또는 CVE-MS17-010(추후에 포스팅 예정)과 대등한 것으로 볼 수 있으며, MBGhost, DeepBlue3:Redmond Drift, BluesDay, CoronBlue, NexternalBlue라는 이름을 붙이고 있습니다.


### _**- 대응방안**_

- 1) 윈도우 보안 업데이트(자동 및 수동으로 업데이트)

```
업데이트 방법
윈도우 설정 > 업데이트 보안 > 윈도우 업데이트
```
- 2) 445 TCP 포트 차단 및 SMB V3 압축 비활성화

```
시작 -> Windows Powershell -> 우클릭 -> 관리자 권한으로 실행

Set-ItemProperty -Path "HKLM:\SYSTEM\CurrentControlSet\Services\LanmanServer\Parameters" DisableCompression -Type DWORD -Value 1 -Force

SMBv3 설정 복구 방법(MS의 업데이트 공개 시, 복구 후 패치 진행)

Set-ItemProperty -Path "HKLM:\SYSTEM\CurrentControlSet\Services\LanmanServer\Parameters" DisableCompression -Type DWORD -Value 0 -Force

```

- 즉 이번 CVE-2020-0796 SMB 취약점 또한 2017년 WannaCry 랜섬웨어가 SMB 서버 취약저믈 악용한 것과 유사한 것을 보이고 있습니다.

```
참고 사이트

https://www.fortinet.com/blog/threat-research/cve-2020-0796-memory-corruption-vulnerability-in-windows-10-smb-server

https://blog.alyac.co.kr/2818


``` 